<div>
  <div class="row" ng-if="$ctrl.workType === 'cp-upload' || ($ctrl.workType === '' && $ctrl.productId)">
    <div class="col-sm-12">
      <h3>Certified Product - Uploads</h3>
      <div>
        <label for="activity-start-upload" class="col-sm-2 control-label">Start Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" ng-model="$ctrl.activityRange.listing.startDate" name="activityStartUpload" id="activity-start-upload" placeholder="yyyy-MM-dd">
        </div>
        <label for="activity-end-upload" class="col-sm-2 control-label">End Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" ng-model="$ctrl.activityRange.listing.endDate" name="activityEndUpload" id="activity-end-upload" placeholder="yyyy-MM-dd">
        </div>
        <div class="col-sm-2">
          <button class="btn btn-primary" ng-click="$ctrl.refreshActivity()" ng-disabled="!$ctrl.validDates('listing')">Search <i class="fa fa-search"></i></button>
        </div>
        <div class="col-sm-12 text-danger" ng-if="!$ctrl.validDates('listing')">Start date must be before end date, and no more than {{ $ctrl.activityRange.range }} days apart</div>
      </div>
      <table st-table="$ctrl.displayedCertifiedProductsUpload" st-safe-src="$ctrl.searchedCertifiedProductsUpload" class="table table-striped">
        <thead>
          <tr>
            <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
            <th class="search-header" st-sort="developer" st-skip-natural="true">Developer</th>
            <th class="search-header" st-sort="product" st-skip-natural="true">Product</th>
            <th class="search-header" st-sort="certificationEdition" st-skip-natural="true">Certification Edition</th>
            <th class="search-header" st-sort="chplProductNumber" st-skip-natural="true">CHPL Product Number</th>
            <th class="search-header" st-sort="certificationDate" st-skip-natural="true">Certification Date</th>
            <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
          </tr>
          <tr>
            <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
            <th><input st-search="developer" placeholder="Filter Developer" class="input-sm form-control" type="search"></th>
            <th><input st-search="product" placeholder="Filter Product" class="input-sm form-control" type="search"></th>
            <th><input st-search="certificationEdition" placeholder="Filter Certification Edition" class="input-sm form-control" type="search"></th>
            <th><input st-search="chplProductNumber" placeholder="Filter CHPL Product Number" class="input-sm form-control" type="search"></th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td colspan="7">
              <a type="button" class="btn btn-lg btn-ai-success"
                 ng-csv="$ctrl.displayedCertifiedProductsUpload" filename="CP_Upload_{{ $ctrl.filename }}"
                 csv-header="['ACB', 'Developer', 'Product', 'Certification Edition', 'CHPL Product Number', 'Certification Date', 'Activity Date']"
                 csv-column-order="['acb', 'developer', 'product', 'certificationEdition', 'chplProductNumber', 'friendlyCertificationDate', 'friendlyActivityDate']">
                <i class="fa fa-cloud-download"></i> Download
              </a>
            </td>
          </tr>
        </tfoot>
        <tbody>
          <tr ng-if="$ctrl.displayedCertifiedProductsUpload.length === 0">
            <td colspan="7">No activity found</td>
          </tr>
          <tr ng-repeat="activity in $ctrl.displayedCertifiedProductsUpload" ng-if="$ctrl.displayedCertifiedProductsUpload.length > 0">
            <td>{{ activity.acb }}</td>
            <td>{{ activity.developer }}</td>
            <td>{{ activity.product }}</td>
            <td>{{ activity.certificationEdition }}</td>
            <td>
              <a href="#/product/{{ activity.id }}">{{ activity.chplProductNumber }}</a>
              <a href="#/admin/dpManagement/manage/{{ activity.id }}" class="pull-right"><i class="fa fa-pencil-square-o"></i></a>
            </td>
            <td>{{ activity.certificationDate | date : 'mediumDate' : 'UTC' }}</td>
            <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row" ng-if="$ctrl.workType === 'cp-status' || ($ctrl.workType === '' && $ctrl.productId)">
    <div class="col-sm-12">
      <h3>Certification Status Changes</h3>
      <div>
        <label for="activity-start-status" class="col-sm-2 control-label">Start Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" ng-model="$ctrl.activityRange.listing.startDate" name="activityStartStatus" id="activity-start-status" placeholder="yyyy-MM-dd">
        </div>
        <label for="activity-end-status" class="col-sm-2 control-label">End Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" ng-model="$ctrl.activityRange.listing.endDate" name="activityEndStatus" id="activity-end-status" placeholder="yyyy-MM-dd">
        </div>
        <div class="col-sm-2">
          <button class="btn btn-primary" ng-click="$ctrl.refreshActivity()" ng-disabled="!$ctrl.validDates('listing')">Search <i class="fa fa-search"></i></button>
        </div>
        <div class="col-sm-12 text-danger" ng-if="!$ctrl.validDates('listing')">Start date must be before end date, and no more than {{ $ctrl.activityRange.range }} days apart</div>
      </div>
      <table st-table="$ctrl.displayedCertifiedProductsStatus" st-safe-src="$ctrl.searchedCertifiedProductsStatus" class="table table-striped">
        <thead>
          <tr>
            <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
            <th class="search-header" st-sort="developer" st-skip-natural="true">Developer</th>
            <th class="search-header" st-sort="product" st-skip-natural="true">Product</th>
            <th class="search-header" st-sort="certificationEdition" st-skip-natural="true">Certification Edition</th>
            <th class="search-header" st-sort="chplProductNumber" st-skip-natural="true">CHPL Product Number</th>
            <th class="search-header" st-sort="certificationDate" st-skip-natural="true">Certification Date</th>
            <th>Activity</th>
            <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
          </tr>
          <tr>
            <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
            <th><input st-search="developer" placeholder="Filter Developer" class="input-sm form-control" type="search"></th>
            <th><input st-search="product" placeholder="Filter Product" class="input-sm form-control" type="search"></th>
            <th><input st-search="certificationEdition" placeholder="Filter Certification Edition" class="input-sm form-control" type="search"></th>
            <th><input st-search="chplProductNumber" placeholder="Filter CHPL Product Number" class="input-sm form-control" type="search"></th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td colspan="7">
              <a type="button" class="btn btn-lg btn-ai-success"
                 ng-csv="$ctrl.displayedCertifiedProductsStatus" filename="CP_Status_{{ $ctrl.filename }}"
                 csv-header="['ACB', 'Developer', 'Product', 'Certification Edition', 'CHPL Product Number', 'Certification Date', 'Activity', 'Activity Date']"
                 csv-column-order="['acb', 'developer', 'product', 'certificationEdition', 'chplProductNumber', 'friendlyCertificationDate', 'details', 'friendlyActivityDate']">
                <i class="fa fa-cloud-download"></i> Download
              </a>
            </td>
          </tr>
        </tfoot>
        <tbody>
          <tr ng-if="$ctrl.displayedCertifiedProductsStatus.length === 0">
            <td colspan="8">No activity found</td>
          </tr>
          <tr ng-repeat="activity in $ctrl.displayedCertifiedProductsStatus" ng-if="$ctrl.displayedCertifiedProductsStatus.length > 0">
            <td>{{ activity.acb }}</td>
            <td>{{ activity.developer }}</td>
            <td>{{ activity.product }}</td>
            <td>{{ activity.certificationEdition }}</td>
            <td>
              <a href="#/product/{{ activity.id }}">{{ activity.chplProductNumber }}</a>
              <a href="#/admin/dpManagement/manage/{{ activity.id }}" class="pull-right"><i class="fa fa-pencil-square-o"></i></a>
            </td>
            <td>{{ activity.certificationDate | date : 'mediumDate' : 'UTC' }}</td>
            <td ng-bind-html="activity.details"></td>
            <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row" ng-if="$ctrl.workType === 'cp-surveillance' || ($ctrl.workType === '' && $ctrl.productId)">
    <div class="col-sm-12">
      <h3>Surveillance Activity</h3>
      <div>
        <label for="activity-start-surveillance" class="col-sm-2 control-label">Start Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" ng-model="$ctrl.activityRange.listing.startDate" name="activityStartSurveillance" id="activity-start-surveillance" placeholder="yyyy-MM-dd">
        </div>
        <label for="activity-end-surveillance" class="col-sm-2 control-label">End Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" ng-model="$ctrl.activityRange.listing.endDate" name="activityEndSurveillance" id="activity-end-surveillance" placeholder="yyyy-MM-dd">
        </div>
        <div class="col-sm-2">
          <button class="btn btn-primary" ng-click="$ctrl.refreshActivity()" ng-disabled="!$ctrl.validDates('listing')">Search <i class="fa fa-search"></i></button>
        </div>
        <div class="col-sm-12 text-danger" ng-if="!$ctrl.validDates('listing')">Start date must be before end date, and no more than {{ $ctrl.activityRange.range }} days apart</div>
      </div>
      <table st-table="$ctrl.displayedCertifiedProductsSurveillance" st-safe-src="$ctrl.searchedCertifiedProductsSurveillance" class="table table-striped">
        <thead>
          <tr>
            <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
            <th>Action</th>
            <th>Activity</th>
            <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
          </tr>
          <tr>
            <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td colspan="4">
              <a type="button" class="btn btn-lg btn-ai-success"
                 ng-csv="$ctrl.displayedCertifiedProductsSurveillance" filename="CP_Surveillance_{{ $ctrl.filename }}"
                 csv-header="['ACB', 'Action', 'Activity', 'Activity Date']"
                 csv-column-order="['acb', 'action', 'csvDetails', 'friendlyActivityDate']">
                <i class="fa fa-cloud-download"></i> Download
              </a>
            </td>
          </tr>
        </tfoot>
        <tbody>
          <tr ng-if="$ctrl.displayedCertifiedProductsSurveillance.length === 0">
            <td colspan="8">No activity found</td>
          </tr>
          <tr ng-repeat="activity in $ctrl.displayedCertifiedProductsSurveillance" ng-if="$ctrl.displayedCertifiedProductsSurveillance.length > 0">
            <td>{{ activity.acb }}</td>
            <td ng-bind-html="activity.action"></td>
            <td>
              <ul class="list-unstyled" ng-if="activity.details && activity.details.length > 0">
                <li ng-repeat="str in activity.details | orderBy : 'toString()' track by $index" ng-bind-html="str"></li>
              </ul>
              <button class="btn btn-sm btn-ai-success" ng-click="$ctrl.compareSurveillances(activity.source.oldS,activity.source.newS)" ng-if="activity.source"><i class="fa fa-search"></i>View Details</button>
            </td>
            <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="row" ng-if="$ctrl.workType === 'cp-other' || ($ctrl.workType === '' && $ctrl.productId)">
    <div class="col-sm-12">
      <h3>Other Certified Product Activities</h3>
      <div>
        <label for="activity-start-other" class="col-sm-2 control-label">Start Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" ng-model="$ctrl.activityRange.listing.startDate" name="activityStartOther" id="activity-start-other" placeholder="yyyy-MM-dd">
        </div>
        <label for="activity-end-other" class="col-sm-2 control-label">End Date</label>
        <div class="col-sm-3">
          <input type="date" class="form-control" ng-model="$ctrl.activityRange.listing.endDate" name="activityEndOther" id="activity-end-other" placeholder="yyyy-MM-dd">
        </div>
        <div class="col-sm-2">
          <button class="btn btn-primary" ng-click="$ctrl.refreshActivity()" ng-disabled="!$ctrl.validDates('listing')">Search <i class="fa fa-search"></i></button>
        </div>
        <div class="col-sm-12 text-danger" ng-if="!$ctrl.validDates('listing')">Start date must be before end date, and no more than {{ $ctrl.activityRange.range }} days apart</div>
      </div>
      <table st-table="$ctrl.displayedCertifiedProducts" st-safe-src="$ctrl.searchedCertifiedProducts" class="table table-striped">
        <thead>
          <tr>
            <th class="search-header" st-sort="acb" st-skip-natural="true">ONC-ACB</th>
            <th class="search-header" st-sort="developer" st-skip-natural="true">Developer</th>
            <th class="search-header" st-sort="product" st-skip-natural="true">Product</th>
            <th class="search-header" st-sort="certificationEdition" st-skip-natural="true">Certification Edition</th>
            <th class="search-header" st-sort="chplProductNumber" st-skip-natural="true">CHPL Product Number</th>
            <th class="search-header" st-sort="certificationDate" st-skip-natural="true">Certification Date</th>
            <th>Activity</th>
            <th class="search-header" st-sort="date" st-skip-natural="true" st-sort-default="reverse">Activity Date</th>
          </tr>
          <tr>
            <th><input st-search="acb" placeholder="Filter ONC-ACB" class="input-sm form-control" type="search"></th>
            <th><input st-search="developer" placeholder="Filter Developer" class="input-sm form-control" type="search"></th>
            <th><input st-search="product" placeholder="Filter Product" class="input-sm form-control" type="search"></th>
            <th><input st-search="certificationEdition" placeholder="Filter Certification Edition" class="input-sm form-control" type="search"></th>
            <th><input st-search="chplProductNumber" placeholder="Filter CHPL Product Number" class="input-sm form-control" type="search"></th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
          </tr>
        </thead>
        <tfoot>
          <tr>
            <td colspan="7">
              <a type="button" class="btn btn-lg btn-ai-success"
                 ng-csv="$ctrl.displayedCertifiedProducts" filename="CP_Other_{{ $ctrl.filename }}"
                 csv-header="['ACB', 'Developer', 'Product', 'Certification Edition', 'CHPL Product Number', 'Certification Date', 'Activity', 'Activity Date']"
                 csv-column-order="['acb', 'developer', 'product', 'certificationEdition', 'chplProductNumber', 'friendlyCertificationDate', 'csvDetails', 'friendlyActivityDate']">
                <i class="fa fa-cloud-download"></i> Download
              </a>
            </td>
          </tr>
        </tfoot>
        <tbody>
          <tr ng-if="$ctrl.displayedCertifiedProducts.length === 0">
            <td colspan="8">No activity found</td>
          </tr>
          <tr ng-repeat="activity in $ctrl.displayedCertifiedProducts" ng-if="$ctrl.displayedCertifiedProducts.length > 0">
            <td>{{ activity.acb }}</td>
            <td>{{ activity.developer }}</td>
            <td>{{ activity.product }}</td>
            <td>{{ activity.certificationEdition }}</td>
            <td>
              <a href="#/product/{{ activity.id }}">{{ activity.chplProductNumber }}</a>
              <a href="#/admin/dpManagement/manage/{{ activity.id }}" class="pull-right"><i class="fa fa-pencil-square-o"></i></a>
            </td>
            <td>{{ activity.certificationDate | date : 'mediumDate' : 'UTC' }}</td>
            <td>
              <ul class="list-unstyled" ng-if="activity.details">
                <li ng-repeat="str in activity.details | orderBy : 'toString()' track by $index" ng-bind-html="str"></li>
              </ul>
            </td>
            <td>{{ activity.date | date : 'MMM d, y H:mm:ss Z' : 'UTC' }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
