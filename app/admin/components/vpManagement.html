<section class="row">
<!--  <div class="col-sm-3 admin-nav">
    <div class="panel panel-default">
      <ul class="nav nav-pills nav-stacked">
        <li ng-class="{'active': vm.workType === 'upload'}" ng-if="vm.isAcbAdmin || vm.isAcbStaff"><a href="" class="" ng-click="vm.doWork('upload')">Upload Certified Products</a></li>
        <li ng-class="{'active': vm.workType === 'confirm'}" ng-if="vm.isAcbAdmin || vm.isAcbStaff"><a href="" class="" ng-click="vm.doWork('confirm')">Confirm Pending Product<span ng-if="vm.uploadingCps.length > 1">s</span> <span class="badge">{{ vm.uploadingCps.length }}</span> </a></li>
        <li ng-class="{'active': vm.workType === 'manage'}"><a href="" class="" ng-click="vm.doWork('manage')">Manage Developers &amp; Products</a></li>
      </ul>
    </div>
  </div>
-->
  <div class="col-sm-12 admin-inner-tab">
    <div class="row admin-label-spaced lead text-center" ng-if="vm.workType==='merge'">
      <ul class="list-inline">
        <li><strong>What would you like to merge?</strong></li>
        <li><input type="radio" ng-model="vm.mergeType" value="developer" id="rdDev"></input><label for="rdDev">Developers</label></li>
        <li><input type="radio" ng-model="vm.mergeType" value="product" id="rdPrd"></input><label for="rdPrd">Products</label></li>
        <li><input type="radio" ng-model="vm.mergeType" value="version" id="rdVer"></input><label for="rdVer">Versions</label></li>
      </ul>
    </div>
    <div class="row" ng-if="vm.workType==='manage'">
      &nbsp;
    </div>
    <div class="row" ng-if="vm.workType === 'upload'">
      <div class="col-sm-12" ng-if="vm.isAcbAdmin || vm.isAcbStaff">
        <h3>Upload Certified Products</h3>
        <input type="file" nv-file-select="" uploader="vm.uploader" />
        <p ng-if="vm.uploadMessage.length > 0">{{ vm.uploadMessage }}</p>
        <table class="table" ng-if="vm.uploader.queue.length > 0">
          <thead>
            <tr>
              <th width="50%">Name</th>
              <th ng-show="vm.uploader.isHTML5">Size</th>
              <th ng-show="vm.uploader.isHTML5">Progress</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="item in vm.uploader.queue">
              <td><strong>{{ item.file.name }}</strong></td>
              <td ng-show="vm.uploader.isHTML5" nowrap>{{ item.file.size/1024/1024|number:2 }} MB</td>
              <td ng-show="vm.uploader.isHTML5">
                <div class="progress" style="margin-bottom: 0;">
                  <div class="progress-bar" role="progressbar" ng-style="{ 'width': item.progress + '%' }"></div>
                </div>
              </td>
              <td nowrap>
                <button type="button" class="btn btn-success btn-xs" ng-click="item.upload()" ng-disabled="item.isReady || item.isUploading || item.isSuccess">
                  <i class="fa fa-cloud-upload"></i> Upload
                </button>
                <button type="button" class="btn btn-warning btn-xs" ng-click="item.cancel()" ng-disabled="!item.isUploading">
                  <i class="fa fa-ban"></i> Cancel
                </button>
                <button type="button" class="btn btn-danger btn-xs" ng-click="item.remove()">
                  <i class="fa fa-trash-o"></i> Remove
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div> <!-- end upload certified products -->

    <div class="row" ng-if="(vm.isAcbAdmin || vm.isAcbStaff) && vm.workType === 'confirm'">
      <div class="col-sm-12">
        <h3>View Products in the process of upload</h3>
        <p ng-if="vm.uploadingCps.length === 0">No products currently in queue</p>
        <table class="table table-striped" ng-if="vm.uploadingCps.length > 0">
          <thead>
            <tr>
              <th>Developer</th>
              <th>Product</th>
              <th>Version</th>
              <th>Certification date</th>
              <th>Status</th>
              <th class="text-center">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="cp in vm.uploadingCps | orderBy: 'certificationDate'">
              <td>{{ cp.vendor.name }}</td>
              <td>{{ cp.product.name }}</td>
              <td>{{ cp.product.version }}</td>
              <td>{{ cp.certificationDate | date }}</td>
              <td><span ng-bind-html="vm.parseUploadError(cp)"></span></td>
              <td class="text-center" ng-if="cp.recordStatus.toLowerCase() === 'new'">
                <button class="btn btn-success btn-block" ng-click="vm.inspectCp(cp.id)"><i class="fa fa-pencil-square-o"></i> Inspect</button>
              </td>
              <td class="text-center" ng-if="cp.recordStatus.toLowerCase() !== 'new'">
                <span>
                  Please {{ cp.recordStatus }} the already exisiting product using the OpenCHPL Website
                  <button class="btn btn-danger btn-block"
                          confirm="Are you sure you wish to reject this Certified Product?"
                          confirm-ok="Yes"
                          confirm-cancel="No"
                          confirm-settings="{animation: false, keyboard: false, backdrop: 'static'}"
                          ng-click="vm.rejectCp(cp.id)"><i class="fa fa-trash-o"></i> Reject</button>
                </span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div> <!-- end of upload process table -->

    <div ng-if="vm.workType === 'manage'" class="row">
      <div class="col-sm-12">
          <p>In the 'Manage Developers and Products' module, you can manage existing health IT developers and certified products. To edit developer or product information, begin by selecting the desired developer below. To edit information about that developer, click the 'Edit Developer' button, and make any desired changes. Once you are satisfied with your changes, click the 'Save Developer' button, or click 'Cancel Edits' to discard your changes.</p>
          <p>To make changes to a certified product or a version of a product, continue by selecting the desired product and version, and clicking the corresponding 'Edit Product' or 'Edit Version' button.</p>
      </div>
    </div>

    <div ng-if="vm.workType === 'merge'" class="row">
      <div class="col-sm-12">
        <p>In the 'Merge Developers and Products' module, you can merge existing health IT developers, certified products, or versions of certified products. To begin, select either developers, products, or versions, for merging.</p>
        <span ng-if="vm.mergeType === 'developer'">
          <p>Select the developers to merge by holding the Control (CTRL) button while clicking the desired developers. Then click the 'Choose Developers' button.</p>
          <p>Inspect the chosen developers to be merged, and enter or edit information for the new merged Developer. Once you are satisfied with your changes, click the 'Save Combined Developer' button, or click 'Cancel Edits' to discard your changes.</p>
        </span>
        <p ng-if="vm.mergeType !== 'developer'">Select a desired developer from the dropdown list, and click 'Choose' to proceed.</p>
      </div>
    </div>

    <div ng-if="vm.workType === 'manage' || vm.workType === 'merge'"> <!-- developer -->
      <div class="row">
        <div class="col-sm-12" ng-if="vm.activeVendor === '' && (vm.workType === 'manage' || vm.mergeType !== 'developer')">
          <div class="form-horizontal">
            <div class="form-group admin-label-spaced">
              <div class="col-sm-3">
                <label for="vendorSelect" class="control-label">Developer</label>
              </div>
              <div class="col-sm-7">
                <select ng-model="vm.vendorSelect"
                        id="vendorSelect" class="form-control col-sm-8"
                        ng-options="v.name for v in vm.vendors | orderBy: 'name'">
                  <option value="" selected disabled>Select a developer</option>
                </select>
              </div>
              <div class="col-sm-2">
                <button class="btn btn-default form-control" ng-click="vm.selectVendor()">Choose</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-12" ng-if="vm.workType === 'merge' && vm.mergeType === 'developer'">
          <label for="vendorMergeSelect" class="control-label admin-label-spaced">Select developers to merge</label>
          <select ng-model="vm.mergingVendors" multiple="true"
                  id="vendorMergeSelect" class="input-sm form-control"
                  size="12" ng-options="v.name for v in vm.vendors | orderBy: 'name'">
          </select>
          <p><button ng-disabled="vm.mergingVendors.length < 2" class="btn btn-default btn-block" ng-click="vm.mergeDevelopers()">Choose Developers</button></p>
        </div>
      </div> <!-- end select developer -->

      <div class="row" ng-if="vm.activeVendor !== ''">
        <div class="col-sm-12">
          <h3 ng-if="vm.inspectingCp">System developer information</h3>
          <div class="panel panel-default panel-admin">
            <div class="panel-heading">
              <span>Select a developer</span>
              <span class="pull-right">
                <span ng-if="vm.workType !== 'merge'"><a href="" ng-click="vm.editDeveloper()"><i class="fa fa-pencil-square-o"></i> Edit Developer</a> |</span>
                <a href="" ng-click="vm.activeVendor = ''; vm.activeProduct = ''; vm.activeVersion = ''; vm.activeCP = ''"><i class="fa fa-refresh"></i> Reset selection</a>
              </span>
            </div>
            <div class="panel-body">
              <div>{{ vm.activeVendor.name }} <em class="pull-right">Last modified date: {{ vm.activeVendor.lastModifiedDate | date }}</em></div>
              <div>
                Line 1: {{ vm.activeVendor.address.line1 }}<br />
                Line 2: {{ vm.activeVendor.address.line2 }}<br />
                City: {{ vm.activeVendor.address.city }}<br />
                State: {{ vm.activeVendor.address.state }}<br />
                Zip: {{ vm.activeVendor.address.zipcode }}<br />
                Country: {{ vm.activeVendor.address.country }}<br />
                Website: {{ vm.activeVendor.website }}<br />
              </div>
              <p ng-if="vm.vendorMessage !== undefined" class="bg-danger">{{ vm.vendorMessage }}</p>
            </div>
          </div>
        </div> <!-- end system developer -->
      </div> <!-- end active developer -->

      <div ng-if="vm.workType === 'merge' && vm.activeVendor !== ''" class="row">
        <div class="col-sm-12">
          <span ng-if="vm.mergeType === 'product' && vm.products.length > 1">
            <p>Select the products to merge by holding the Control (CTRL) button while clicking the desired products. Then click the 'Choose Products' button.</p>
            <p>Inspect the chosen products to be merged, and enter or edit information for the new merged Product. When you are satisfied with your changes, click the 'Save Combined Product' button, or click 'Cancel Edits' to discard your changes.</p>
          </span>
          <p ng-if="vm.mergeType !== 'product'">Select a desired product from the dropdown list, and click 'Choose' to proceed.</p>
        </div>
      </div>

      <div class="row" ng-if="vm.activeProduct === '' && vm.activeVendor !== '' && (vm.mergeType !== 'developer' || vm.workType !== 'merge')"> <!-- product -->
        <div class="col-sm-12" ng-if="vm.workType === 'manage' || vm.mergeType !== 'product'">
          <div class="form-horizontal">
            <div class="form-group admin-label-spaced">
              <div class="col-sm-3">
                <label for="productSelect" class="control-label admin-label-spaced">Product</label>
              </div>
              <div class="col-sm-7">
                <select ng-model="vm.productSelect"
                        id="productSelect" class="form-control"
                        ng-options="p.name for p in vm.products | orderBy: 'name'">
                  <option value="" selected disabled>Select a product</option>
                </select>
              </div>
              <div class="col-sm-2">
                <button class="btn btn-default form-control" ng-click="vm.selectProduct()">Choose</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-12" ng-if="vm.mergeType === 'product' && vm.products.length > 1">
          <label for="productMergeSelect" class="control-label admin-label-spaced">Select products to merge</label>
          <select ng-model="vm.mergingProducts" multiple="true"
                  id="productMergeSelect" class="input-sm form-control"
                  size="12" ng-options="p.name for p in vm.products | orderBy: 'name'">
          </select>
          <p><button ng-disabled="vm.mergingProducts.length < 2" class="btn btn-default btn-block" ng-click="vm.mergeProducts()">Choose Products</button></p>
        </div>
        <div class="col-sm-12" ng-if="vm.workType === 'merge' && vm.mergeType === 'product' && vm.products.length <= 1">
          <p><strong>No products are available for merge</strong></p>
        </div> <!-- end product merge select -->
      </div> <!-- end select product -->

      <div class="row" ng-if="vm.activeProduct !== ''">
        <div class="col-sm-12">
          <div class="panel panel-default panel-admin">
            <div class="panel-heading">
              <span>Select a product</span>
              <span class="pull-right">
                <span ng-if="vm.workType !== 'merge'"><a href="" ng-click="vm.editProduct()"><i class="fa fa-pencil-square-o"></i> Edit Product</a> |</span>
                <a href="" ng-click="vm.activeProduct = ''; vm.activeVersion = ''; vm.activeCP = ''"><i class="fa fa-refresh"></i> Reset selection</a>
              </span>
            </div>
            <div class="panel-body">
              <div>{{ vm.activeProduct.name }} <em class="pull-right">Last modified date: {{ vm.activeProduct.lastModifiedDate | date }}</em></div>
              <p ng-if="vm.productMessage !== undefined" class="bg-danger">{{ vm.productMessage }}</p>
            </div>
          </div>
        </div> <!-- end system product -->
      </div>

      <div ng-if="vm.workType === 'merge' && vm.activeProduct !== ''" class="row">
        <div class="col-sm-12">
          <span ng-if="vm.mergeType === 'version' && vm.versions.length > 1">
            <p>Select the versions to merge by holding the Control (CTRL) button while clicking the desired versions. Then click the 'Choose Versions' button.</p>
            <p>Inspect the chosen versions to be merged, and enter or edit information for the new merged Version. When you are satisfied with your changes, click the 'Save Combined Version' button, or click 'Cancel Edits' to discard your changes.</p>
          </span>
          <p ng-if="vm.mergeType !== 'version'">Select a desired version from the dropdown list, and click 'Choose' to proceed.</p>
        </div>
      </div>

      <div class="row" ng-if="vm.activeProduct !== '' && vm.activeVendor !== '' && vm.activeVersion === '' && ((vm.mergeType !== 'developer' && vm.mergeType !== 'product') || vm.workType !== 'merge')"> <!-- version -->
        <div class="col-sm-12" ng-if="vm.workType === 'manage' || vm.mergeType !== 'version'">
          <div class="form-horizontal">
            <div class="form-group admin-label-spaced">
              <div class="col-sm-3">
                <label for="versionSelect" class="control-label admin-label-spaced">Version</label>
              </div>
              <div class="col-sm-7">
                <select ng-model="vm.versionSelect"
                        id="versionSelect" class="form-control"
                        ng-options="v as v.version for v in vm.versions | orderBy: 'version'">
                  <option value="" selected disabled>Select a version</option>
                </select>
              </div>
              <div class="col-sm-2">
                <button class="btn btn-default form-control" ng-click="vm.selectVersion()">Choose</button>
              </div>
            </div>
          </div>
        </div>
        <div class="col-sm-12" ng-if="vm.mergeType === 'version' && vm.versions.length > 1">
          <label for="versionMergeSelect" class="control-label admin-label-spaced">Select versions to merge</label>
          <select ng-model="vm.mergingVersions" multiple="true"
                  id="versionMergeSelect" class="input-sm form-control"
                  size="12" ng-options="v as v.version for v in vm.versions | orderBy: 'version'">
          </select>
          <p><button ng-disabled="vm.mergingVersions.length < 2" class="btn btn-default btn-block" ng-click="vm.mergeVersions()">Choose Versions</button></p>
        </div>
        <div class="col-sm-12" ng-if="vm.workType === 'merge' && vm.mergeType === 'version' && vm.versions.length <= 1">
          <p><strong>No versions are available for merge</strong></p>
        </div> <!-- end version merge select -->
      </div> <!-- end select version -->
      <div class="row" ng-if="vm.activeVersion !== ''">
        <div class="col-sm-12">
          <div class="panel panel-default panel-admin">
            <div class="panel-heading">
              <span>Select a version</span>
              <span class="pull-right">
                <span ng-if="vm.workType !== 'merge'"><a href="" ng-click="vm.editVersion()"><i class="fa fa-pencil-square-o"></i> Edit Version</a> |
                <a href="" ng-click="vm.activeVersion = ''; vm.activeCP = ''"><i class="fa fa-refresh"></i> Reset selection</a>
              </span>
            </div>
            <div class="panel-body">
              <div>{{ vm.activeVersion.version }} <em class="pull-right">Last modified date: {{ vm.activeVersion.lastModifiedDate | date }}</em></div>
              <p ng-if="vm.versionMessage !== undefined" class="bg-danger">{{ vm.versionMessage }}</p>
            </div>
          </div>
        </div> <!-- end system version -->
      </div>

      <div class="row" ng-if="vm.activeVersion !== '' && vm.workType !== 'merge'">
        <div class="col-sm-12">
          <div class="form-horizontal" ng-if="vm.activeCP === ''">
            <div class="form-group admin-label-spaced">
              <span ng-if="vm.cps.length > 0">
                <div class="col-sm-3">
                  <label for="cpSelect" class="control-label admin-label-spaced">Certified Product</label>
                </div>
                <div class="col-sm-7">
                  <select ng-model="vm.cpSelect" id="cpSelect" class="input-sm form-control">
                    <option value="" selected disabled>Select a Certified Product</option>
                    <option ng-repeat="cp in vm.cps | orderBy: 'certificationDate'" value="{{ cp.id }}">{{ cp.chplProductNumber }} ({{ cp.lastModifiedDate | date }})</option>
                  </select>
                </div>
                <div class="col-sm-2">
                  <button class="btn btn-default form-control" ng-click="vm.selectCp()">Choose</button>
                </div>
              </span>
              <div class="col-sm-12" ng-if="vm.cps.length === 0">
                <p><strong>No Certified Products are available for edit</strong></p>
              </div>
            </div>
          </div>
          <div ng-if="vm.activeCP !== ''">
            <div class="panel panel-default panel-admin">
              <div class="panel-heading">
                <span>Select a Certified Product</span>
                <span class="pull-right">
                  <a href="#/product/{{ vm.activeCP.id}}"><i class="fa fa-search"></i> View Product Listing</a> |
                  <a href="" ng-click="vm.editCertifiedProduct()"><i class="fa fa-pencil-square-o"></i> Edit Certified Product</a> |
                  <a href="" ng-click="vm.activeCP = ''"><i class="fa fa-refresh"></i> Reset selection</a>
                </span>
              </div>
              <div class="panel-body">
                <span>
                  <strong>CHPL Product Number:</strong>{{ vm.activeCP.chplProductNumber }} <em class="pull-right">Last modified date: {{ vm.activeCP.lastModifiedDate | date }}</em><br />
                  <strong>Classification:</strong> {{ vm.activeCP.classificationType.name }} <br />
                  <strong>Practice Type:</strong> {{ vm.activeCP.practiceType.name }} <br />
                  <strong>Certification Edition:</strong> {{ vm.activeCP.certificationEdition.name }} <br />
                  <strong>Certification Body:</strong> {{ vm.activeCP.certifyingBody.name }} <br />
                  <strong>Certification Date:</strong> {{ vm.activeCP.certificationDate | date }} <br />
                  <ai-additional-software additional-software="vm.activeCP.additionalSoftware" is-editing="false"></ai-additional-software> <br />
                  <strong>Status:</strong> {{ vm.activeCP.certificationStatus.name }}<br />
                  <strong>ACB Certification Id:</strong> {{ vm.activeCP.acbCertificationId }} <br />
                  <strong>Other ACB:</strong> {{ vm.activeCP.otherAcb }} <br />
                  <strong>Quality Management System Attestation:</strong> {{ vm.activeCP.qualityManagementSystemAtt }} <br />
                  <strong>Privacy and Security Attestation:</strong> {{ vm.activeCP.privacyAttestation }} <br />
                  <strong>Report File Location:</strong> {{ vm.activeCP.reportFileLocation }} <br />
                  <strong>Testing Lab:</strong> {{ vm.activeCP.testingLabId }} <br />
                  <strong>Visible on CHPL:</strong> {{ vm.activeCP.visibleOnChpl }} <br />
                  <strong>Surveillance:</strong> <ai-surveillance
                                                    surveillances="vm.activeCP.surveillances"
                                                    certified-product-id="vm.activeCP.id"
                                                    certification-results="vm.activeCP.certificationResults"
                                                    is-admin="true"></ai-surveillance><br />
                  <strong>Corrective Action Plan:</strong> <ai-corrective-action-plan
                                                              corrective-action-plan="vm.activeCP.cap"
                                                              certified-product-id="vm.activeCP.id"
                                                              certification-results="vm.activeCP.certificationResults"
                                                              is-admin="true"></ai-corrective-action-plan><br />
                </span>
                <br />
                <ai-certs ng-if="vm.activeCP !== ''"
                          certs="vm.activeCP.certificationResults"
                          cqms="vm.activeCP.cqmResults"
                          count-certs="{{ vm.activeCP.countCerts }}"
                          count-cqms="{{ vm.activeCP.countCqms }}"
                          default-all="true"
                          edit-mode="false"
                          report-file-location="{{ vm.activeCP.reportFileLocation }}">
                </ai-certs>
                <p ng-if="vm.cpMessage !== undefined" class="bg-danger">{{ vm.cpMessage }}</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
